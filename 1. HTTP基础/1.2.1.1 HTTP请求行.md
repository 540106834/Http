
#  **HTTP 请求行概述**

HTTP 请求行是 HTTP 请求报文的 **第一行**，用于告诉服务器：

* 客户端要执行的操作（方法）
* 请求的资源位置（路径/URL）
* 使用的 HTTP 协议版本

**通用格式：**

```
<方法> <请求目标> <HTTP版本>
```

示例：

```
GET /api/users?id=123 HTTP/1.1
```

---

## **1️ 方法（HTTP Method）**

表示请求类型，也就是客户端希望服务器执行的动作。

| 方法      | 功能     | 示例                                 | 使用场景        |
| ------- | ------ | ---------------------------------- | ----------- |
| GET     | 获取资源   | `GET /users HTTP/1.1`              | 查询用户列表、访问网页 |
| POST    | 提交资源   | `POST /users HTTP/1.1`             | 创建用户        |
| PUT     | 替换资源   | `PUT /users/123 HTTP/1.1`          | 完整更新用户信息    |
| PATCH   | 部分更新   | `PATCH /users/123 HTTP/1.1`        | 更新用户部分字段    |
| DELETE  | 删除资源   | `DELETE /users/123 HTTP/1.1`       | 删除用户        |
| HEAD    | 仅获取响应头 | `HEAD /users HTTP/1.1`             | 检查资源存在性、监控  |
| OPTIONS | 查询支持方法 | `OPTIONS /users HTTP/1.1`          | CORS 预检请求   |
| TRACE   | 回显请求   | `TRACE /users HTTP/1.1`            | 调试用途        |
| CONNECT | 建立隧道   | `CONNECT example.com:443 HTTP/1.1` | HTTPS 代理连接  |

 **注意**：

* GET/HEAD 不应有请求体
* POST/PUT/PATCH 常携带请求体
* DELETE 也可以带请求体，但多数 API 不建议

---

## **2️ 请求目标（Request Target）**

请求目标指明客户端请求的资源。
它的形式取决于使用场景：

1. **绝对路径（最常用）**

```
GET /api/users?id=123 HTTP/1.1
```

* `/api/users` → 资源路径
* `?id=123` → 查询参数（Query String）

2. **绝对 URL（通常代理使用）**

```
GET http://example.com/api/users HTTP/1.1
```

3. **星号（*）**

```
OPTIONS * HTTP/1.1
```

* 表示针对整个服务器操作，不指定资源

 **注意**：

* 查询参数需 URL 编码，例如空格 → `%20`
* 多值参数用 `&` 分隔，例如 `?tag=go&tag=k8s`

---

## **3️ HTTP 版本**

HTTP 协议版本，用于告知服务器客户端能理解的协议特性。

| 版本       | 特点                        |
| -------- | ------------------------- |
| HTTP/1.0 | 简单，默认短连接，每次请求建立/关闭 TCP 连接 |
| HTTP/1.1 | 默认长连接，支持管道化和 chunked 传输   |
| HTTP/2   | 二进制传输、多路复用、头压缩，提高性能       |
| HTTP/3   | 基于 QUIC 协议，0-RTT，低延迟      |

 **注意**：

* HTTP/1.1 默认 `Host` 头必填
* HTTP/2/3 在客户端和服务器协商升级（Upgrade 或 TLS ALPN）

---

## **4️⃣ 请求行案例解析**

### **案例 1：GET 请求**

```
GET /api/users?page=2&limit=20 HTTP/1.1
Host: example.com
```

解析：

* **方法**：GET → 请求获取资源
* **请求目标**：`/api/users?page=2&limit=20` → 资源路径 + 查询参数
* **HTTP版本**：1.1 → 支持持久连接
* **Host**：example.com → 虚拟主机标识

---

### **案例 2：POST 请求**

```
POST /api/orders HTTP/1.1
Host: example.com
Content-Type: application/json

{
  "productId": 123,
  "quantity": 2
}
```

解析：

* **方法**：POST → 提交数据
* **请求目标**：`/api/orders` → 指向订单创建接口
* **HTTP版本**：1.1 → 支持长连接
* **请求体**：JSON 格式订单数据

---

### **案例 3：OPTIONS（CORS 预检）**

```
OPTIONS /api/users HTTP/1.1
Host: example.com
Origin: https://client.com
Access-Control-Request-Method: POST
```

解析：

* **方法**：OPTIONS → 查询服务器允许的方法
* **请求目标**：`/api/users` → 检查该资源
* **HTTP版本**：1.1
* **Origin / Access-Control-Request-Method** → CORS 预检信息

---

## **5️ 实战技巧**

1. **curl 查看请求行**

```bash
curl -v -X GET "http://example.com/api/users?page=2"
```

* `-v` 输出完整请求报文
* 第一行就是请求行

2. **日志分析**

* Nginx/Apache 日志：`"GET /api/users?page=2 HTTP/1.1"` → 请求行
* 可快速判断请求类型、路径、参数

3. **微服务链路**

* 请求行 + 请求头 + 响应状态码 → 可以还原完整请求

---

 **总结**

* **请求行 = 方法 + 目标 + 版本**
* 方法决定操作，目标指向资源，版本决定协议特性
* 请求行是 HTTP 报文最基础的部分，理解它有助于 **调试 API、分析日志、抓包、微服务链路追踪**


