ä¸‹é¢ç»™ä½ **æœ€æ¸…æ™°ã€æœ€æ ‡å‡†ã€é¢è¯• + å®æˆ˜çº§åˆ«**çš„ **HTTP å“åº”æ ¼å¼ï¼ˆHTTP Response Formatï¼‰**ã€‚

æ•´ä»½å†…å®¹ä¸ä½ ä¹‹å‰é—®çš„è¯·æ±‚æ ¼å¼ä¸€ä¸€å¯¹åº”ã€‚

---

# ğŸŸ¥ ä¸€ã€HTTP å“åº”æ ¼å¼ç”±å››éƒ¨åˆ†ç»„æˆ

```
<1> çŠ¶æ€è¡Œ (Status Line)
<2> å“åº”å¤´ (Response Headers)
<3> ç©ºè¡Œ
<4> å“åº”ä½“ (Bodyï¼Œå¯é€‰)
```

æ ¼å¼ç±»ä¼¼ï¼š

```
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 27

{"status": "ok"}
```

---

# ğŸŸ¦ äºŒã€çŠ¶æ€è¡Œï¼ˆStatus Lineï¼‰

æ ¼å¼ï¼š

```
<åè®®ç‰ˆæœ¬> <çŠ¶æ€ç > <çŠ¶æ€æè¿°>
```

ä¾‹å¦‚ï¼š

```
HTTP/1.1 200 OK
HTTP/1.1 404 Not Found
HTTP/1.1 500 Internal Server Error
```

---

# ğŸŸ© ä¸‰ã€å“åº”å¤´ï¼ˆResponse Headersï¼‰

å¸¸è§å“åº”å¤´ï¼š

| Header         | ä½œç”¨                         |
| -------------- | -------------------------- |
| Content-Type   | body çš„ç±»å‹ï¼ˆJSON / HTML / å›¾ç‰‡ï¼‰ |
| Content-Length | body çš„å­—èŠ‚é•¿åº¦                 |
| Server         | æœåŠ¡ç«¯ç±»å‹ï¼ˆNginxã€Gunicornï¼‰      |
| Date           | å“åº”æ—¶é—´                       |
| Cache-Control  | ç¼“å­˜ç­–ç•¥                       |
| Set-Cookie     | è®¾ç½® cookie                  |

ç¤ºä¾‹ï¼š

```
Content-Type: application/json
Content-Length: 154
Server: nginx/1.20.1
Date: Tue, 26 Nov 2024 08:12:00 GMT
```

---

# ğŸŸ¨ å››ã€ç©ºè¡Œï¼ˆé‡è¦ï¼‰

Header ä¸ Body **ä¹‹é—´å¿…é¡»æœ‰ä¸€ä¸ªç©ºè¡Œ**ï¼š

```
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 20

{"message": "ok"}
```

---

# ğŸŸª äº”ã€å“åº”ä½“ï¼ˆBodyï¼‰

ä¸»è¦åœ¨ 200/201/400/500 ç³»åˆ—å“åº”ä¸­å‡ºç°ã€‚

å¸¸è§ç±»å‹ï¼š

## 1ï¼‰JSON

```
Content-Type: application/json

{"data": "hello"}
```

API æœ€å¸¸ç”¨ã€‚

---

## 2ï¼‰HTML

```
Content-Type: text/html

<html>
  <body>Hello</body>
</html>
```

æµè§ˆå™¨ç”¨é€”ã€‚

---

## 3ï¼‰çº¯æ–‡æœ¬

```
Content-Type: text/plain

ok
```

---

## 4ï¼‰æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶ï¼‰

```
Content-Type: application/octet-stream

<binary data>
```

ä¾‹å¦‚ zipã€å›¾ç‰‡ã€éŸ³é¢‘ç­‰ã€‚

---

# ğŸŸ¥ å…­ã€å®Œæ•´ HTTP å“åº”ç¤ºä¾‹ï¼ˆåŸå§‹æ ¼å¼ï¼‰

è¿™æ˜¯ä»çœŸå® Web æœåŠ¡å™¨æŠ“åŒ…å¯ä»¥çœ‹åˆ°çš„åŸå§‹æ ¼å¼ï¼š

```
HTTP/1.1 200 OK
Date: Mon, 25 Nov 2024 10:11:21 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 152
Connection: keep-alive
Server: gunicorn/20.1.0

{"status":"success","message":"alert received","timestamp":"2024-11-25T10:11:21Z"}
```

---

# ğŸŸ§ ä¸ƒã€å¸¸è§çŠ¶æ€ç åˆ†ç±»

| çŠ¶æ€ç  | æè¿°                 |
| --- | ------------------ |
| 1xx | æç¤ºä¿¡æ¯ï¼ˆåŸºæœ¬ä¸å¸¸è§ï¼‰        |
| 2xx | æˆåŠŸï¼ˆ200ã€201 æœ€å¸¸ç”¨ï¼‰    |
| 3xx | é‡å®šå‘ï¼ˆ301ã€302ï¼‰       |
| 4xx | å®¢æˆ·ç«¯é”™è¯¯ï¼ˆ400ã€401ã€404ï¼‰ |
| 5xx | æœåŠ¡ç«¯é”™è¯¯ï¼ˆ500ã€502ã€503ï¼‰ |

æœ€å¸¸ç”¨ï¼š

* `200 OK`
* `201 Created`
* `400 Bad Request`
* `401 Unauthorized`
* `404 Not Found`
* `500 Internal Server Error`

---

# ğŸŸ¦ å…«ã€å¯¹åº”ä½ çš„åœºæ™¯ï¼šAlertmanager Webhook çš„çœŸå®å“åº”ç¤ºä¾‹

Alertmanager å¯¹ webhook çš„å“åº”è¦æ±‚ **éå¸¸å®½æ¾**ï¼š

åªè¦è¿”å› 2xx å°±ç®—æˆåŠŸã€‚

ä¾‹å¦‚ï¼š

```
HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 2

OK
```

æˆ–è€…ï¼š

```
HTTP/1.1 202 Accepted
```

ä¹Ÿå¯ä»¥ã€‚

---

# ğŸŸ© ä¹ã€Flask æ¡†æ¶ä¸­çš„å“åº”ç¤ºä¾‹

```python
from flask import jsonify

@app.route("/alert", methods=["POST"])
def alert():
    return jsonify({"status": "ok"}), 200
```

Flask è‡ªåŠ¨ç”Ÿæˆå®Œæ•´ HTTP å“åº”æ ¼å¼ï¼š

```
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 16

{"status":"ok"}
```

---

# ğŸŸª åã€æ€»ç»“ï¼ˆé¢è¯•å›ç­”æ¨¡æ¿ï¼‰

**ä¸€ä¸ª HTTP å“åº”ç”±å››éƒ¨åˆ†ç»„æˆï¼š**

```
<çŠ¶æ€è¡Œ>
<å“åº”å¤´>
<ç©ºè¡Œ>
<å“åº”ä½“>
```

å“åº”ä½“æ ¼å¼ç”± `Content-Type` å†³å®šã€‚
Alertmanagerã€Prometheus ç­‰ webhook åªè¦æ±‚è¿”å› 2xx å³å¯ã€‚

---

å¦‚æœä½ éœ€è¦ï¼Œæˆ‘å¯ä»¥ç»§ç»­æä¾›ï¼š

âœ” HTTP/1.1 vs HTTP/2 å“åº”åŒºåˆ«
âœ” å®Œæ•´åŒå‘ï¼ˆè¯·æ±‚+å“åº”ï¼‰å¯¹ç…§å›¾
âœ” äºŒè¿›åˆ¶æ–‡ä»¶å“åº”æ ¼å¼
âœ” Python socket æ‰‹å†™ HTTP æœåŠ¡ç«¯ï¼ˆæ— æ¡†æ¶ï¼‰

ä½ æƒ³ç»§ç»­å“ªéƒ¨åˆ†ï¼Ÿ
